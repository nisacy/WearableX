//
//  ECCSecurity.h
//  Wearable
//
//  Created by Admin on 2017/2/27.
//  Copyright © 2017年 wearable. All rights reserved.
//

#import <Foundation/Foundation.h>
#import "atcacert_def.h"
#import "atcacert_date.h"
#import <CommonCrypto/CommonDigest.h>

#define ROOT_CERT_HEXSTR @"308201AE30820154A003020102021067A1D9E471BD4A4B936E37232361EE3F300A06082A8648CE3D040302302F3111300F060355040A0C08547261696E696E67311A301806035504030C1141544543433530384120526F6F742043413020170D3135303932383032353932365A180F39393939313233313233353935395A302F3111300F060355040A0C08547261696E696E67311A301806035504030C1141544543433530384120526F6F742043413059301306072A8648CE3D020106082A8648CE3D03010703420004F92904F3BFD06C5C42024CC35E048B3FA3C7C3C807C66FA9E418421E340F947CBD4DDF526FD95AA0557E4808AC11FB855009CF59DB4F050B4D3D67AAE997C491A350304E301D0603551D0E04160414370AA13AEBEBCF098970826B3AB274FB967268D3301F0603551D23041830168014370AA13AEBEBCF098970826B3AB274FB967268D3300C0603551D13040530030101FF300A06082A8648CE3D0403020348003045022100E322C3755EF7BA05783B938B4A77C895E8CFFEEA3BC34720304B1AA0C4407FAC02203E6418EA028C5B417FCE71060FFEAC625916468D4C30DB33CC5FC7E80C6626E5"
#define ROOT_PUBLIC_KEY_HEXSTR  @"F92904F3BFD06C5C42024CC35E048B3FA3C7C3C807C66FA9E418421E340F947CBD4DDF526FD95AA0557E4808AC11FB855009CF59DB4F050B4D3D67AAE997C491"
#define PUBLIC_KEY_LENGTH 64
#define SIGNATURE_LENGTH 64
extern Byte signer_cert[];
extern Byte device_cert[];
@interface ECCSecurity : NSObject
- (void)init_signer_cert_def:(atcacert_def_t*)signer_cert_def device_cert_def:(atcacert_def_t*)device_cert_def;
- (BOOL)reconstruct_cert_with_certdef:(atcacert_def_t)cert_def  ca_pk:( NSMutableData *)ca_pk compert:( NSMutableData *)compcert pk:( NSMutableData *)pk fullcert:( Byte *) x509_cert;
- (void) test;
+ (void)x509Verify:(NSData *)publicKeyData chanllengeData:(NSData *)chanllengeData responseData:(NSData *)responseData;
+ (void)x509Verify:(NSData *)root_cert signer_cert:(NSData *)signer_cert device_cert:(NSData *)device_cert;
@end
